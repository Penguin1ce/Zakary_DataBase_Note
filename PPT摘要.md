## 2.1.1数据模型分类

**概念数据模型 CDM**：Conceptual Data Model

​	实体-联系模型**E-R**模型

**逻辑数据模型 LDM**：Logic Data Model

​	层次，网状，关系

## 2.1.3逻辑数据模型

### 数据模型的三要素

**数据结构**:描述数据库的组成对象以及对象之间的联系

**数据操纵**:是指对数据库中各种对象的实例允许执行的操作的集合,主要有查询和更新（包括插入、删除、修改）两大类操作。

**完整性约束**:是给定的数据模型中的数据及其联系所具有的制约和依存规则，用以限定符合数据模型的数据库状态以及状态的变化，以保证数据的正确、有效和相容。

## 2.1.4 层次模型

层次模型（hierarchical data model），数据模型是有根的定向有序树，表示各类实体以及实体间的联系。

1. 只有一个结点没有双亲结点，称为根结点。
2. 根以外的其他结点有且只有一个双亲结点。

<img src="./assets/image-20241205125846342.png" alt="image-20241205125846342" style="zoom:50%;" />

优点

​	层次模型的数据结构比较简单清晰。

​	记录之间的联系通过指针实现，查询效率较高。

缺点

​	现实世界中很多联系是非层次性的，如结点之间具有多对多联系，或者一个结点具有多个双亲结点，不适合层次模型表示。

## 2.1.5 网状模型 

网状模型（network data model），数据模型是有向图。

1. 允许一个以上的结点无双亲结点。

2. 一个结点可以有多于一个的双亲结点。

![image-20241205130717351](./assets/image-20241205130717351.png)

优点

​	能更为直接地描述现实世界，M:N联系容易实现

​	记录之间的联系通过指针实现，查询效率较高。

缺点

​	结构比较复杂，不利于最终用户掌握。

​	编写应用程序较复杂，程序员必须熟悉数据库的逻辑结构。

## 2.2 关系模型

关系模型优点：

​	1. 关系模型建立在严格的数学概念基础上。

​	2. 数据结构简单、清晰，用户易懂易用。

​	3. 关系模型的存取路径对用户隐蔽。有更强的数据独立性、更好的安全保密性，简化了程序员的工作。

## **2.2.3** **关系的键**KEY（码）

超键(SuperKey)：在一个关系中，可**唯一地标识元组的**一个属性或属性集合。

候选键 (Candidate Key)：能唯一标识一个关系的元组而又**不含有多余的属性的**一个属性或属性集合。

**候选键是不是超键？**

候选键是超键的子集，因此：

- **每一个候选键都是超键**。
- **但不是每一个超键都是候选键**，因为超键可以包含冗余属性。

**如果关系的全部属性构成关系的候选键**，则称为**全键(All-Key)**。

构成候选键的诸属性称为**主属性(Prime Attribute**)。

不包含在任意候选键中的属性称为**非主属性(Non-Prime Attribute)**。

**主键 (Primary Key/PK)：**关系中用户选择一个候选键作为插入，删除或检索元组的操作变量，被选用的候选键称为主键。

**外键(Foreign Key/FK)：**是指关系R中的属性A不是关系R的主键，但A是另一个关系S的主键，则属性A就是关系R的外键。其中R是参照关系，S是被参照关系。

外键在关系R中的取值有两种可能：或为**空值**，或必须是**被参照关系S中已有的属性值**。

外键值是否允许为空值，主要依赖于应用环境的语义。

## 2.2.4关系规则

第一范式(First Normal Form，1NF)

实体完整性规则

参照完整性规则

用户定义的完整性规则

**第一范式(First Normal Form，1NF)：**是指关系数据库中表的每一分量都是不可分割的基本数据项（原子性）。

|        | **家庭住址** |          |
| :----: | :----------: | :------: |
| **省** |   **城市**   | **街道** |

这种情况不允许。

**实体完整性规则：**定义关系中主键的取值不能为空值。

**参照完整性规则：**若属性或属性组F是关系R的外键，它与关系S的主键Ks相对应，则对于R中每个元组在F上的值或者取空值；或者等于S中某个元组的主键值。

**用户定义的完整性规则：**针对某一具体关系数据库的约束条件，反映某一具体应用所涉及的数据必须满足的语义要求。

## 2.4.2自然关系运算

<img src="./assets/image-20241205132625276.png" alt="image-20241205132625276" style="zoom:75%;" />

等值连接：

<img src="./assets/image-20241205132917491.png" alt="image-20241205132917491" style="zoom:50%;" />

自然连接：

<img src="./assets/image-20241205132934347.png" alt="image-20241205132934347" style="zoom:50%;" />

采用θ连接表示如下：

<img src="./assets/image-20241205140213829.png" alt="image-20241205140213829" style="zoom:80%;" />

n采用乘法表示如下:

<img src="./assets/image-20241205140310660.png" alt="image-20241205140310660" style="zoom:80%;" />

<img src="./assets/image-20241205140629500.png" alt="image-20241205140629500" style="zoom: 33%;" />

<img src="./assets/image-20241205140723783.png" alt="image-20241205140723783" style="zoom:70%;" />

<img src="./assets/image-20241205140743400.png" alt="image-20241205140743400" style="zoom:50%;" />

<img src="./assets/image-20241205140757372.png" alt="image-20241205140757372" style="zoom:33%;" />

### 题目

3.设有一个数据库Library，包括Book，Borrow，Reader四个关系模式：

Book(Bno，Btitle，Bauthor，Bprice)；

Borrow(Rno，Bno，BorrowDate，ReturnDate)；

Reader(Rno，Rname，Rsex，Rage，Reducation)；

图书表Book由图书编号(Bno)、图书名称(Btitle)、图书作者(Bauthor)、图书价格(Bprice)组成；

借阅表Borrow由读者编号(Rno)、图书编号(Bno)、借阅时间(BorrowDate)、归还时间(ReturnDate)组成；

读者表Reader由读者编号(Rno)、读者姓名(Rname)、读者性别(Rsex)、读者年龄(Rage)、读者学历(Reducation)组成。

针对数据库Library，用关系代数表达式表示下列查询语句。

①查询全体读者的姓名(Rname)、出生年份。

②查询所有年龄在18~20岁(包括18岁和20岁)之间的读者姓名(Rname)及年龄(Rage)。

③查询学历为研究生的读者的编号(Rno)、姓名(Rname)和性别(Rsex)。

④查询读者的借书情况，要求列出读者姓名，图书标题，借书日期。

⑤查询所有读者的基本情况和借书情况，没有借书的读者也输出基本信息。

⑥查询所有借了编号为B02的图书的读者编号(Rno)和读者姓名(Rname)。

⑦查询至少借阅了读者R01借阅的全部书籍的读者编号(Rno)和读者姓名(Rname)。

⑧查询图书名称包含“数据库” 和价格低于50元的图书的信息。

## 3.3 MySQL的组件结构

**连接器：**负责跟客户端建立连接、权限校验、获取权限、维持和管理连接。

**分析器：**对SQL的词法和语法进行分析。词法分析是分析出SQL中字符串代表的含义，识别对应的关键字。语法分析是根据语法的规则判断SQL是否满足MySQL的语法。

**优化器：**选择出最优的查询方案，或者重写查询（对一些执行耗费性能的语句，会依据一些规则，尽
 力转换成某种可高效执行的形式，比如决定表的读取顺序，选择需要的索引等）。

**执行器：**执行优化后的查询方案。执行前要判断当前用户是否有操作表的权限，如果有，则会根据表的存储引擎定义调用相应接口，对数据进行操作；如果无权限则报错。



**引擎层（存储引擎）：**是对于数据库文件的一种存取机制，如何实现存储数据，如何为存储的数据建立索引以及如何更新、查询数据等技术实现的方法。架构模式是插件式的，支持多个存储引擎。

**InnoDB引擎：**事务型存储引擎，提供对数据库事务的ACID支持，实现SQL标准的四种隔离级别，具有行级锁定，适用于高并发情形及外键支持。MySQL 5.5.5 版本后InnoDB成为了默认存储引擎。

**MYISAM引擎：**不支持事务，不支持细粒度的锁（行锁）及外键，当表Insert与update时需要锁定整个表，效率低，高并发时可能会遇到瓶颈。

MYISAM独立于操作系统，可以在Windows及Linux上使用。MYISAM具有高效的查询速度，插入数据的速度很快，在web、数据仓库等应用环境中常用。

**Memory引擎：**表数据是存储在内存中的，由于会受到硬件问题或断电问题的影响，只能将这些表作为临时表或缓存使用。

​	特点：

​	①内存存放，读写速度快

​	②hash索引（默认）

**存储引擎选择：**

​	如果要提供提交、回滚和崩溃恢复能力的事务安全（ACID兼容）能力，并要求实现并发控制，选择InnoDB。

​	如果数据表主要用来插入和查询记录，则MyISAM引擎能提供较高的处理效率。

​	如果只是临时存放数据，数据量不大，并且不需要较高的数据安全性，可以选择将数据保存在内存中的Memory引擎。

## 3.6 MySQL的数据库

### 系统数据库

**mysql：**存储MySQL服务器运行时所需信息的表。包含存储数据库对象元数据的数据字典表、用于其他操作目的的系统表。

**information_schema：** 提供对数据库元数据、有关MySQL服务器的信息（例如数据库或表的名称、列的数据类型或访问权限）的访问。该数据库包含几个只读表（实际上是视图，而不是基表）。

**performance_schema：**该数据库的表是不使用持久磁盘存储的内存表，内容在服务器启动时重新填充，并在服务器关闭时丢弃。提供对有关服务器执行的有用信息的访问，同时对服务器性能的影响最小。

**sys：**通过视图的形式把information_schema和performance_schema 结合起来，帮助系统管理员监控MySQL的技术性能。可用于典型的调优和诊断用例。

### 示例数据库

示例数据库既可以用于日常学习和测试，也可以作为设计数据库的一个参考。

**Sakila ：**是一个在线 DVD 出租数据库。提供了actor、film、film_actor等16个表、7个视图、3个存储过程、3个函数。

**world** 是一个小型的简单数据库，主要用于基础查询测试。

## 4.1 SQL概述

### SQL的特点

 **（1）综合统一**

​	DQL(Data Query Language，数据查询语言 )

​	DML(Data Manipulation Language，数据操纵语言)

​	DDL(Data Definition Language，数据定义语言)

​	DCL(Data Control Language，数据控制语言 ) 

**（2）非过程化**

**（3）面向集合的操作方式**

**（4）提供交互式和嵌入式**

**（5）语言简洁**

| SQL功能  | **关键动词**            |
| :------- | :---------------------- |
| 数据查询 | SELECT                  |
| 数据定义 | CREATE,  DROP, ALTER    |
| 数据操纵 | INSERT,  UPDATE, DELETE |
| 数据控制 | GRANT,  REVOKE          |